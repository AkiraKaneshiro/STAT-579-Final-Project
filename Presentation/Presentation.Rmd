---
title: "Analysis of the Yelp Academic Dataset"
author: "Chelsey Legacy, Lindong Zhou, Evan 'Pete'?? Walsh"
date: "November 22, 2014"
output: 
  ioslides_presentation:
    logo: logo.jpg
runtime: shiny
---

```{r echo=FALSE}
suppressPackageStartupMessages(require(dplyr))
suppressPackageStartupMessages(require(googleVis))
suppressPackageStartupMessages(require(wordcloud))
suppressPackageStartupMessages(require(tm))
food <- read.csv("/Users/marianwaitwalsh/Github/STAT-579-Final-Project/Data/Restaurants/food.csv")
tips <- read.csv("/Users/marianwaitwalsh/Github/STAT-579-Final-Project/Data/Restaurants/tips.csv")
```

## Intro



## Schedule {.smaller}

Our presentation will procede as follows:

> - Brief description of data
> - Restaurants
>     + The cost of reservations
>     + Loud can be good, but not too loud
>     + It's all about service
>     + Delivery vs. takeout
> - Bars
>     + Food
>     + Stars
>     + Popular features
> - Hotels
> - Shopping

# Data

## Raw data format

Words

## Data cleaning process | Subtitle



# Restaurants

----

```{r, echo=FALSE}
shinyApp(
  ui = fluidPage(responsive = FALSE,
                 fluidRow(style = "padding-bottom: 20px;",
                  column(2, selectInput("place", label = "Region", 
                            levels(food$state), selected = "WI")),
                  column(4, selectInput("type", label = "Type",
                            choices = levels(food$type), 
                            selected = levels(food$type)[1],
                            multiple = TRUE)),
                  column(2, selectInput("hour", label = "Hour",
                            choices = c("All", "Breakfast",
                                        "Lunch", "Dinner"),
                            selected = "All")),
                  column(2, selectInput("lower", label = "Rating low",
                            choices = as.character(seq(1,5, by=0.5)),
                            selected = "4")),
                  column(2, selectInput("upper", label = "Rating high",
                            choices = as.character(seq(1,5,by=0.5)),
                            selected = "5"))),
                 htmlOutput("map")
                 ),
  
  server = function(input, output) {
    dataInput <- reactive({      
      if (input$hour == "Breakfast") {
        df <- food %>% subset(state == input$place, stars > 4) %>%
          filter(type %in% input$type) %>%
          filter(stars >= as.numeric(input$lower) & 
                   stars <= as.numeric(input$upper))
        df <- df[grep("breakfast': True", df$attributes_good.for),]
      }      
      else if (input$hour == "Lunch") {
        df <- food %>% subset(state == input$place, stars > 4) %>%
          filter(type %in% input$type) %>%
          filter(stars >= as.numeric(input$lower) & 
                   stars <= as.numeric(input$upper))
        df <- df[grep("lunch': True", df$attributes_good.for),]
      }      
      else if (input$hour == "Dinner") {
        df <- food %>% subset(state == input$place, stars > 4) %>%
          filter(type %in% input$type) %>%
          filter(stars >= as.numeric(input$lower) & 
                   stars <= as.numeric(input$upper))
        df <- df[grep("dinner': True", df$attributes_good.for),]
      }      
      else {
      df <- food %>% subset(state == input$place, stars > 4) %>%
        filter(type %in% input$type) %>%
        filter(stars >= as.numeric(input$lower) & 
                 stars <= as.numeric(input$upper))        
      }
    })
    
    output$map <- renderGvis({
      gvis1 <- gvisMap(dataInput(), "location", "tip",
                 options = list(showTip = TRUE, 
                                enableScrollWheel = TRUE,
                                useMapTypeControl = TRUE,
                                mapType = "normal"))
      gvis1
    })
  }
)
```

## The cost of reservations


## Noise pollution


## It's all about service

```{r echo=FALSE}
shinyApp(
  ui = fluidPage(responsive = FALSE,
    fluidRow(
      column(3, wellPanel(
        sliderInput("n", "Sample size:", min = 300, 
                  max = 1000, value = 600, step = 10),
        submitButton("Draw")
      )),
      column(6,
        plotOutput("wordcloud", width = 500, height = 500)
      )         
    )),
  
  server = function(input, output) {
    dataInput <- reactive({
      top <- tips %>% subset(stars > 4) %>% select(2)
      top <- sample(top$text, input$n) %>% 
        paste(sep = '', collapse = ' ')
      top <- gsub("[[:punct:]]", " ", top)
      top <- tolower(top)
      top <- gsub("great", '', top)
      top <- gsub("good", '', top)
      top <- gsub("best", '', top)
      top <- gsub("food", '', top)
      top <- gsub("love", '', top)
      top <- gsub("don", '', top)
      top <- gsub("get" , '', top)
      top <- gsub("try", '', top)
      top <- gsub("place", '', top)
      top <- gsub("amazing", '', top)
      top <- gsub("awesome", '', top)
      top
    })
    output$wordcloud <- renderPlot({
      wordcloud(dataInput(), max.words = 100, random.order=F, 
          scale=c(3,0.5),colors=brewer.pal(4,"Dark2"))
    })
  }
)
```

